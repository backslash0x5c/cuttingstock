# 鉄筋切断最適化システム

鉄筋の切断ストック問題を解決する最適化システムです。複数の原材料長から様々な長さの鉄筋を切断する際に、材料の廃材を最小化する最適な切断パターンを計算します。

## プロジェクト概要

これは鉄筋の切断問題を解決する鉄筋切断在庫最適化システムです。深さ優先探索アルゴリズムと整数線形計画法を使用して、鉄筋の切断計画を最適化します。

## コマンド

### アプリケーションの実行
```bash
# Streamlitウェブインターフェースを実行
streamlit run cutting_optimizer_streamlit.py

# コマンドライン最適化器を実行
python cutting_optimizer_ver2.py
```

### 依存関係
システムには以下のPythonパッケージが必要です：
- `streamlit`: ウェブインターフェース
- `pulp`: 整数線形計画法ソルバー
- `openpyxl`: Excelファイル処理
- `pandas`: データ処理

### 異なる径でのテスト
main関数内の`diameter`変数を変更してください（通常'D10', 'D13', 'D16', 'D19', 'D22'）。

## アーキテクチャ

### 主要コンポーネント

1. **最適化器**:
   - `cutting_optimizer_streamlit.py`: 統合最適化機能付きメインウェブインターフェース
   - `cutting_optimizer_ver2.py`: Excel統合機能付きコマンドライン版
   - `cutting_optimizer_dual.py`: 実験的列生成アプローチ（未完成）

2. **データ処理**:
   - `read_xlsx.py`: マルチシート対応の切断要求Excelパーサー
   - `result_sheet.py`: Excel形式への結果出力

### 主要アルゴリズム

- **深さ優先探索 (DFS)**: 材料制約内での有効な切断組み合わせを再帰探索により生成
- **整数線形計画法 (ILP)**: PuLPライブラリを使用して切断パターンを最適化し廃材を最小化
- **列生成**: デュアル版での実験的アプローチ（実装未完成）

### 鉄筋仕様

システムは5つの標準鉄筋径と定義済み在庫長さに対応：

```python
BASE_PATTERNS = {
    'D10': [4000, 4500, 5500, 6000],
    'D13': [3000, 4000, 4500, 5500, 6000, 7500],
    'D16': [4000, 4500, 5500, 6000, 7000],
    'D19': [3500, 4000, 4500, 5500, 6000],
    'D22': [4000, 4500, 5500, 6000]
}
```

### データフロー

1. **入力**: 切断要求を含むExcelファイル（`required_cuts.xlsx`）
2. **処理**: `find_cell_position()`と`get_diameter_column_index()`を使用して鉄筋径データを抽出
3. **組み合わせ生成**: DFSを使用して在庫制約内での有効な切断パターンを探索
4. **最適化**: 120秒タイムアウトでILP問題を解いて廃材を最小化
5. **出力**: 歩留まり率と材料使用統計を含む切断指示を表示

### ファイル構造

- **入力ファイル**: "鉄筋径"ヘッダーを持つExcelファイル
- **結果ファイル**: 処理結果と比較データを含む`result/`ディレクトリに配置

### パフォーマンス考慮事項

- 組み合わせ生成は大規模問題で計算コストが高い
- デフォルト最適化タイムアウト: 120秒
- 結果には処理時間と歩留まり率の計算が含まれる
- DFSはcurrent_sum > max_sumの場合に無効な分岐を避ける枝刈りを使用